<section class="contact" data-bind="foreach: contact">
  <div class="contact__section" data-collapse="container">
    <div class="collapse in">
      <h1 class="contact__name__text" data-bind="text: fullname"></h1>
      
      <div class="btn-group contact__options">
        <button title="Options" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cog"></i> <span class="dropdown__label">Options</span> <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right contact__options__dropdown">
          <li data-toggle="collapse">Edit Name</li>
          <li data-bind="click: deleteContact">Delete Contact</li>
        </ul>
      </div>
    </div>
    <form class="contact__form contact__form--name collapse" data-bind="submit: updateData">
      <label class="sr-only" for="lastname">Full Name</label>
      <div class="input-group">
        <input name="lastname" class="form-control" type="text" data-bind="textInput: fullname"/>
        <span class="input-group-btn">
          <button class="btn btn-primary" type="submit">Save</button>
        </span>
      </div>
    </form>
  </div>



  <div class="contact-details">
    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader contact__subheader--top">Position &amp; Company
        <span class="edit--toggle is-disabled" data-toggle="collapse">
          <i class="fa fa-pencil-square"></i> 
            Edit
        </span>
      </h5>

      <div class="collapse in contact__display contact__career">
        <!-- ko if: customImage -->
        <img class="contact__image" data-bind="attr:{src: customImage, alt: fullname}" />          
        <!-- /ko -->
        <!-- ko if: !customImage() -->
        <img class="contact__image" data-bind="attr:{alt: fullname}, gravatar: { credential: email, rating: 'pg', defaultImage: 'mm' }" />
        <!-- /ko -->

        <span class="contact__information" data-bind="text: position"></span>
        <span class="contact__information" data-bind="text: company"></span>
      </div>

      <form class="contact__form collapse" data-bind="submit: updateData">
        <label>Position 
          <input name="position" class="form-control" type="text" data-bind="textInput: position"/>
        </label>

        <label>Company 
          <input name="company" class="form-control" type="text" data-bind="textInput: company"/>
        </label>

        <label>Use a different image
          <input name="company" placeholder="Image URL" class="form-control" type="url" data-bind="textInput: customImage"/>
        </label>

        <button class="btn btn-primary" type="submit">Save Changes</button>
        <span class="form__alternate-action contact__form__cancel text-link">Cancel</span>
      </form>
    </div>

    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader">Email Address
        <span class="edit--toggle is-disabled" data-toggle="collapse">
          <i class="fa fa-pencil-square"></i>
          <!-- ko if: email  --> 
            Edit
          <!-- /ko -->
          <!-- ko if: !email()  -->
            Add
          <!-- /ko -->
        </span>
      </h5>
      <div class="collapse in contact__display">
        <a class="contact__information text-link" title="Email them" data-bind="text: email, attr:{href: emailLink}"></a>
      </div>

      <form class="contact__form collapse" data-bind="submit: updateData">
        <label>Email
          <input name="email" class="form-control" type="email" data-bind="textInput: email"/>
        </label>

        <button class="btn btn-primary" type="submit">Save Changes</button>
        <span class="form__alternate-action contact__form__cancel text-link">Cancel</span>
      </form>
    </div>

    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader">Phone
        <span class="edit--toggle is-disabled" data-toggle="collapse">
          <i class="fa fa-pencil-square"></i>
          <!-- ko if: phone  --> 
            Edit
          <!-- /ko -->
          <!-- ko if: !phone()  -->
            Add
          <!-- /ko -->
        </span>
      </h5>
      <div class="collapse in contact__display">
        <a class="contact__information text-link" title="Call them" data-bind="text: phone, attr:{href: phoneLink}"></a>
      </div>

      <form class="contact__form collapse" data-bind="submit: updateData">
        <label>Phone
          <input name="phone" class="form-control" type="tel" data-bind="textInput: phone"/>
        </label>
 
        <button class="btn btn-primary" type="submit">Save Changes</button>
        <span class="form__alternate-action contact__form__cancel text-link">Cancel</span>
      </form>
    </div>
   
    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader">
        <!-- ko if: address --> 
          Address
        <!-- /ko -->
        <!-- ko if: !address() --> 
          Location
        <!-- /ko -->
          <span class="edit--toggle is-disabled" data-toggle="collapse">
            <i class="fa fa-pencil-square"></i>
            <!-- ko if: address() || city() || state() || zipcode()  --> 
              Edit
            <!-- /ko -->
            <!-- ko if: !address() && !city() && !state() && !zipcode()  -->
              Add
            <!-- /ko -->
          </span>
      </h5>
      <div class="collapse in contact__display">
        <!-- ko if: address --> 
        <a class="contact__information text-link" title="Map this address" data-bind="attr:{href: addressLink}">
          <span data-bind="text: address"></span>
          <br /> <!-- Hack: Reason for this related to link styling -->
          <span class="contact__location">
            <!-- ko if: city --> 
            <span data-bind="text: city"></span>
            <!-- /ko -->

            <!-- ko if: state --> 
            <span data-bind="text: state"></span>
            <!-- /ko -->
          </span>
        </a>
        <!-- /ko -->

        <!-- ko if: !address() == true && (city() || state()) --> 
        <span class="contact__location contact__information">
          <span class="contact__city" data-bind="text: city"></span>
          <span data-bind="text: state"></span>
        </span>
        <!-- /ko --> 

        <!-- ko if: !address() && !city() && !state() && !zipcode()  -->
          <span class="contact__information" data-toggle="collapse">Add a location or an address.</span>
        <!-- /ko -->
      </div>
      <form class="contact__form collapse" data-bind="submit: updateData">
        <label>Street Address <span class="form__note--optional">(optional)</span>
          <input name="address" class="form-control" type="text" data-bind="textInput: address"/>
        </label>

        <label>Zipcode <span class="form__note--optional">(optional)</span>
          <input name="zipcode" class="form-control form-control--compact" type="text" data-bind="textInput: zipcode"/>
        </label>

        <label>City <span class="form__note--optional">(optional)</span>
          <input name="city" class="form-control" type="text" data-bind="textInput: city"/>
        </label>

        <label>State <span class="form__note--optional">(optional)</span>
          <input name="state" class="form-control" type="text" data-bind="textInput: state"/>
        </label>

        <button class="btn btn-primary" type="submit">Save Changes</button>
        <span class="form__alternate-action contact__form__cancel text-link">Cancel</span>      
      </form>
    </div>
  </div>
  <div class="contact-background">
    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader contact__subheader--top">Background Notes
        <span class="edit--toggle is-disabled" data-toggle="collapse">
          <i class="fa fa-pencil-square"></i>
          <!-- ko if: notes -->
            Edit
          <!-- /ko -->    
          <!-- ko if: !notes() -->
            Add
          <!-- /ko -->    
        </span>
      </h5>

      <div class="collapse in contact__display">
        <!-- ko if: notes -->
        <p class="contact__information" data-bind="text: notes"></p>
        <!-- /ko -->
        <!-- ko if: !notes() -->
        <span class="contact__information" data-toggle="collapse">Add a note</span>
        <!-- /ko -->
      </div>

      <form class="contact__form collapse" data-bind="submit: updateData">
        <label>Notes
          <textarea name="notes" class="form-control" data-bind="textInput: notes"></textarea>
        </label>
        <small class="form__note"><a class="text-link" tabindex="0" data-toggle="popover" data-placement="bottom" data-html="true" data-trigger="focus" title="Markdown Formatting Guide" data-content="With markdown you use simple characters to format text:<ul><li>###A header</li><li>**Bold Text**</li><li>_Italic Text_</li><li>[A Link](http://a-link.com)</li><li>For more, <a class='text-link' href='https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet'>view this guide</a></li></ul>">Markdown formatting supported</a></small>
      
        <button class="btn btn-primary" type="submit">Save Changes</button>
        <span class="form__alternate-action contact__form__cancel text-link">Cancel</span>
      </form>
    </div>
    
    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader">Reminders
        <span class="edit--toggle is-disabled" data-toggle="collapse">
          <i class="fa fa-pencil-square"></i>
          <!-- ko if: reminders -->
            Edit
          <!-- /ko -->    
          <!-- ko if: !reminders() -->
            Add
          <!-- /ko -->    
        </span>
      </h5>
 
      <div class="collapse in contact__display">
        <!-- ko if: reminders().length >= 1 -->
        <ul>
          <li class="contact__information">
            <p data-bind="text: reminderNote"></p>
            <small>Reminder set for <span data-bind="text: reminderDate"></span></small>
          </li>
        </ul>
        <!-- /ko -->
        <!-- ko if: reminders().length < 1 -->
          <span class="contact__information" data-toggle="collapse">Add a reminder</span>
        <!-- /ko -->
      </div>

      <form class="contact__form collapse" data-bind="submit: updateReminder">
        <legend class="sr-only">Create a Reminder</legend>
        <label>Note for Reminder
          <textarea name="reminderNote" class="form-control" data-bind="textInput: reminderNote"></textarea>
        </label>

        <label>Date for Reminder
          <input name="reminderDate" class="form-control form-control--compact" type="text" id="datepicker" data-bind="textInput: reminderDate">
        </label>

        <button class="btn btn-primary" type="submit">Save Changes</button>
        <span class="form__alternate-action contact__form__cancel text-link">Cancel</span>
      </form>  
    </div>

    <div class="contact__section" data-collapse="container">
      <h5 class="contact__subheader">Tags</h5>
      
      <form class="add-tag-form" data-bind="submit: addTag">
        <label for="add-tag" class="sr-only">Add a new tag</label>
        <div class="input-group">
          <input placeholder="Add a tag" name="add-tag" class="form-control" data-bind="textInput: addTagLabel"/>
          <span class="input-group-btn">
            <button class="btn btn-primary" type="submit">Add</button>
          </span>
        </div>
      </form>

      <!-- ko if: tags -->
      <ul data-bind="foreach: tags">
        <li>
          <button class="tag btn btn-default btn-secondary">
            <span data-bind="text: tagLabel"></span>
            <input type="hidden" data-bind="value: id">
            <i class="tag__close fa fa-close" data-bind="click: $parent.removeTag"></i>
          </button>
        </li>
      </ul>
      <!-- /ko -->
    </div>
  </div>
</section>